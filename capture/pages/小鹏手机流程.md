- TODO 小鹏手机项目实施工作计划
	- 小鹏公众号相关需求理解确认，确认最终实现细节
	- 小鹏视频号相关代码回顾，确认是否需要需求调整，以及最终产品形态
	- 小鹏创作者中心接口对接需求沟通确认
- 需求梳理
  collapsed:: true
	- 养号任务
	  collapsed:: true
		- 主要功能
			- 使用目标手机中当前登陆的账号模拟人类操作随机刷视频进行点赞、评论、盖楼操作
		- 输入
			- 评论数，视频点赞数，盖楼数，视频循环数（最多在多少条视频内进行操作），评论循环数（最多在多少条评论内进行操作）
		- 输出
			- YANGHAO_TASK_RESULT_DATA_TITLE
		- 隐性需求&风险
			- 每个账号都要执行，所以不能以所有设备共享任务消费池的形式进行任务分发，必须保证每个手机都收到任务并执行，执行结构进行上报
			- 因为未关注等原因导致无法进行评论点赞等操作的视频，跳过，并自动补偿一个（流程代码中已实现该逻辑）
			- 由于有随机性要求，所以会在给定的视频循环数、评论循环数内进行随机生成执行任务的目标，所以需要保证输入的合理性以满足随机性、拟人性（流程代码中已实现该逻辑，但可能需要优化）
	- 标题采集
	  collapsed:: true
		- 主要功能：获取数据采集所需要的视频标题入参
		- 输入：*视频号用户id*，采集数量，评论数量要求（传0表示不要求评论数量）
		- 输出：TITLE_COLLECT_TASK_RESULT_DATA_TITLE
		- 隐性需求&风险：
			- 1.需要以所有设备共享任务消费池的形式进行任务分发，以100%保证任务目标达成
			- 2.为了提高根据评论数量晒视频的流程执行效率，当前的实现方式会通过视频页面获取评论数的方法进行初步判断，但由于在视频页面获取的视频评论数包含盖楼评论，实际能采集到的评论可能达不到要求，当前的临时解决方法是通过加权10%来降低不满足的概率(流程代码内实现，与整体调度无关)
	- 数据采集
	  collapsed:: true
		- 主要功能：采集指定视频号用户的指定视频内的最多n条评论内容
		- 输入：*视频号用户id*，视频标题，视频循环数（最多在多少条视频内进行操作，若在循环数内没有匹配到视频标题，则任务失败返回找不到视频），评论数量最大值(默认50条)
		- 输出：COMMENT_COLLECT_TASK_RESULT_DATA_TITLE
		- 隐性需求&风险：
		  1.需要以所有设备共享任务消费池的形式进行任务分发，以100%保证任务目标达成
	- 定向任务
	  collapsed:: true
		- 主要功能：根据视频号用户+视频标题进行评论、或者根据视频号用户+视频标题+目标评论进行点赞评论、或者根据视频号用户+视频标题+目标评论进行盖楼评论
		- 输入：*视频号用户id*，视频标题，目标评论，视频循环数（最多在多少条视频内进行操作，若在循环数内没有匹配到视频标题，则任务失败返回找不到视频），评论数量最最大循环数(最多在多少条评论内进行操作，若在循环数内没有匹配到目标评论，则任务失败返回找不到目标评论)
		- 输出：DIRECTED_TASK_RESULT_DATA_TITLE
		- 隐性需求&风险：
			- 1.需要以所有设备共享任务消费池的形式进行任务分发，以100%保证任务目标达成
			- 2.因为未关注等原因导致无法进行评论点赞等操作的视频要报任务失败，将任务返回任务池，交由其他手机执行任务
	- 交叉调度需求梳理
	  collapsed:: true
		- 需要实现一个任务执行记录表，记录账号在哪个设备、什么时间执行过什么任务，执行结果成功/失败，对应的产出结果等信息，支持后续通过查表快速定位到账号执行任务的频次和结果信息
		  需要记录养号任务结果、数据采集任务结果、标题结果（是否已采集过）、定向任务执行结果，支持快速查询出信息列表，支持根据执行账号、视频号作者id、时间、任务类型等参数快速筛选结果列表，支持导出成为Excel文档
		  任务调度池逻辑：要划分不同优先级的任务池，以满足需要调用顺序的任务（可以发散思维思考下最佳解决方案）
	- 流程任务执行规则与调度顺序梳理
	  collapsed:: true
		- 视频标题采集任务，是采集评论任务的前置任务，采集到的标题可以作为采集评论任务的入参
		- 采集评论任务，是定向任务（评论、盖楼、点赞评论）的前置任务
		- todo继续总结
	- 以mysql数据库为中心的任务调度设计+数据回传保存方案
	  collapsed:: true
		- 背景信息
			- 当前使用docx作为数据存储方式存在很多弊端，没有直接存储到mysql中处理方便，比如实现自动化的流程处理操作较为复杂（其他问题待AI补充）
			- 现在的任务流程调度方式较为复杂，还难以脱离专业人员的管理，比如当一个上游任务（比如采集视频标题是采集评论的上游任务，因为需要先有标题作为采集评论的入参）的某个目标手机执行任务失败时，通常需要管理人员手动进行重新执行任务，还要人工查看返回的数据是否完整，满足要求
			- 当需要群控大量手机并行执行大量任务时，为了避免个别手机执行rpa任务失败而影响整体任务的执行，需要设计一种容错机制，实现一个任务池的概念，当rpa任务不需要特定手机执行（没有执行账号的要求，有些任务是需要指定每个账号都运行一次的，比如养号任务，有些任务是需要尽量均分，比如定向任务，有固定数量个定向任务需要分散到不同账号上执行）时，所有手机平等地从任务池中拉取任务，直到所有任务被确认成功执行，此时如果有些手机执行失败了，返回异常，那么其他手机空闲后可以继续拉取任务执行，就不需要管理人员去手动重新执行任务了
		- 现有调用逻辑
			- 用户要求
				- 养号任务
					- 每个账号：养号1次，5条评论、5条盖楼、10个点赞（次数可能调整）
				- 采集任务
					- 每个账号对应1个大V。每个大V号的2个帖子，每个50条评论。大V号：小鹏汽车、陈震同学、懂车帝原创、自由补充（数量都可能改变，大V号也可能改动，但是目前逻辑是与账号1对1的关系，需要询问用户后续是否有改动的需求）
					- 目前是账号和大V号一对一，但客户的实际需求可能只是为了保证任务均摊运行来保证执行效率，所以和共享任务消费池的方式应该不冲突
				- 定向任务
					- 每个账号：3条评论、3条盖楼、5个点赞
					- 要求是在采集到的评论中，随机抽评论，具体看目前实现的代码逻辑
		-
		-
	- 抽象可复用的逻辑模块（与业务逻辑解藕，实现一些通用框架）
-
-
- DONE 最新会议沟通，关于整体框架实现（2026-0206）总结梳理
- 核心任务分解
	- 对接客户调度中心
		- 接口对接文档产出
			- 视频号调度接口相关文档
			- 流程控制接口
				- 流程停止
				- 任务状态查询接口
			- 回调接口（用于回传任务执行结果，根据任务id进行标识）
		- 用户自己实现调度中心，指定具体手机运行具体任务，参数完全交给用户处理
		- 数据传输加密
			- 接口对接时，需要确保数据加密
			- TODO 待熟悉网络传输加密相关
		- TODO 接口文档
		- 对接联调测试及问题修复
	- 塔斯app功能完善(支撑项目需求)
		- NOW 新版本流程包与运营平台下发任务的兼容性
		  id:: 69899b7d-ff32-4026-990c-e64509099062
		  :LOGBOOK:
		  CLOCK: [2026-02-09 Mon 16:32:03]
		  CLOCK: [2026-02-09 Mon 16:32:09]
		  :END:
		- 支持运行控制，实现通过接口停止流程逻辑（待实现）
			- 手机端目前不支持通过运营平台、控制器进行停止任务
			- NOW 与服务端沟通确认/opt/cmd/1.0.0/bot/work/v3/takeWork接口参数是否包含停止任务的逻辑
			  id:: 6985c42d-899b-49fb-9584-46211efb6125
				- 以及通过什么接口去进行下发停止任务，http://deop.ai-indeed.com/frameWorkPortal/openAPI/v2/job/operation ？
		- 暂停逻辑，暂时难以实现，建议一期不考虑
	- 流程开发完善
		- TODO 随机动作模拟人：比如养号等任务需要执行前/后随机刷视频等待随机时间
		- 运行结果回传
			- 完善失败报错信息，要方便错误排查
				- 失败后报错信息需包括：网络、页面UI、操作步骤等具体内容
				- 失败时需额外支持截图（录屏功能，待客户重新评估）
					- 保存至客户云服务器
			- 流程执行结果（无论成功、失败）信息需要反馈给用户的调度中心
				- TODO 考虑通过回调用户的接口实现数据回传，通过开放入参给用户来设置回传的接口信息
		- 流程运行日志颗粒度（待客户评估）
			- TODO 需要确认是否在运营平台查看日志即可？
			- 当有错误时，要能通过上报的日志快速排查问题
			- 需要确定app中何种指令的日志会被上报运营平台
		- 流程功能需求（具体任务细分）
			- 舆情监控全部为单独任务
				- 账号监控
				- 关键词监控
				- 指定帖子监控
			- 视频号流程完善（一期）
			- 公众号任务开发（二期）
	- 流程稳定性运行框架设计
		- TODO 整体框架逻辑设计
		- 要确保任务不会死循环一直卡住，可以通过最大运行时长限制
			- TODO 任务执行超时处理机制（运营平台已支持），需要熟悉原理
		- 失败排错机制，需要与流程内的报错标准同时考虑
		- 重试机制
			- TODO 运营平台重试机制原理熟悉
			- TODO 与客户沟通确认重试方式，要构思如何区分哪些是需要重试解决的问题，哪些是重试也无法解决需要立即上报处理的